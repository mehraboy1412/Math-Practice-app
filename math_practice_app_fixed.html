<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Math Practice: Multiplication, Squares & Cubes</title>
  <style>
    :root {
      --primary: #4CAF50;
      --secondary: #00f2fe;
      --bg-gradient: linear-gradient(135deg, #cef5a3 0%, #8ee3f5 100%);
      --card-bg: #ffffff;
      --text-dark: #333;
      --text-light: #fff;
      --input-bg: #fafafa;
      --border-light: #ddd;
      --error-color: #e74c3c;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-gradient);
      color: var(--text-dark);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      background: var(--card-bg);
      border-radius: 2rem;
      box-shadow: 0 8px 24px rgba(0,0,0,0.1);
      padding: 2.5rem 2rem;
      width: 100%;
      max-width: 420px;
      text-align: center;
      transition: transform 0.3s ease;
    }
    .container:hover { transform: translateY(-4px); }
    h2 {
      font-size: 1.75rem;
      margin: 0;
      color: var(--primary);
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }
    .form-group { margin-top: 1.5rem; text-align: left; }
    label { display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-dark); }
    select, input {
      width: 100%;
      padding: 0.6rem 0.8rem;
      border: 1px solid var(--border-light);
      border-radius: 0.75rem;
      background: var(--input-bg);
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
      font-size: 1rem;
      transition: border-color 0.3s ease, color 0.3s ease;
    }
    select:focus, input:focus {
      border-color: var(--primary);
      outline: none;
    }
    input.wrong {
      border-color: var(--error-color) !important;
      color: var(--error-color) !important;
    }
    #question-label {
      margin: 2rem 0;
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--text-dark);
      text-align: center;
      min-height: 3rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #result { margin-top: 0.5rem; font-size: 1.1rem; font-weight: 600; min-height: 1.2rem; }
    #score, #accuracy, #timer, #session-timer { margin-top: 1rem; font-size: 0.9rem; color: var(--text-dark); }
    button {
      margin-top: 1.8rem;
      padding: 0.8rem 1.6rem;
      font-size: 1rem;
      border: none;
      border-radius: 1rem;
      background: var(--primary);
      color: var(--text-light);
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(76,175,80,0.3);
      transition: background-color 0.3s ease, transform 0.2s ease;
    }
    button:hover { background: #45a049; transform: scale(1.03); }
    #progress-bar { margin-top: 2rem; width: 100%; background: #eee; border-radius: 1rem; overflow: hidden; height: 0.75rem; }
    #progress { height: 100%; background: var(--secondary); width: 0; transition: width 0.3s ease; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Math Practice Hub</h2>
    <div id="controls">
      <div class="form-group"><label>Select Mode</label><select id="mode" onchange="toggleOptions()"><option value="multiplication">Multiplication</option><option value="division">Division</option><option value="square">Square</option><option value="cube">Cube</option><option value="exponent">Exponent</option><option value="count">Count</option></select></div>
      <div class="form-group"><label>Select Tables/Numbers</label><select id="tables" multiple></select></div>
      <div class="form-group" id="exponent-range-group" style="display:none;"><label>Exponent Range</label><div style="display:flex;gap:1rem;"><input type="number" id="exponent-min" placeholder="Min" min="1" max="20" value="1" /><input type="number" id="exponent-max" placeholder="Max" min="1" max="3" value="3" /></div></div>
      <div class="form-group" id="count-range-group" style="display:none;"><label>Count Step (increment)</label><input type="number" id="count-step" placeholder="Step" min="1" max="50" value="1" /></div>
      <div class="form-group"><label>Session Type</label><select id="session-type" onchange="toggleSessionType()"><option value="time">Time-based</option><option value="count">Question Count</option></select></div>
      <div class="form-group" id="time-group"><label>Practice Time (minutes)</label><input type="number" id="practice-time" value="5" min="1" max="60" /></div>
      <div class="form-group" id="count-group" style="display:none;"><label>Number of Questions</label><input type="number" id="question-count" value="20" min="1" max="1000" /></div>
      <button id="startBtn" onclick="startPractice()">Start Practice</button>
    </div>
    <div id="session-timer"></div>
    <div id="question-label"></div>
    <input type="number" id="answer" placeholder="Your answer" style="display:none;" />
    <div id="result"></div>
    <div id="score"></div>
    <div id="accuracy"></div>
    <div id="timer"></div>
    <div id="progress-bar"><div id="progress"></div></div>
  </div>
<script>
  let mode, tables, practiceSeconds, score, totalQuestions, totalAttempts, startTime, currentAnswer, answerStr;
  let questionLimit;

  function toggleOptions() {
    const m = document.getElementById('mode').value;
    document.getElementById('exponent-range-group').style.display = m==='exponent'?'block':'none';
    document.getElementById('count-range-group').style.display = m==='count'?'block':'none';
  }

  function toggleSessionType() {
    const t = document.getElementById('session-type').value;
    document.getElementById('time-group').style.display = t==='time'?'block':'none';
    document.getElementById('count-group').style.display = t==='count'?'block':'none';
  }

  function updateProgressBar(correct, total) {
    const pct = total ? Math.round((correct/total) * 100) : 0;
    document.getElementById('progress').style.width = pct + '%';
  }

  function populateTables() {
    const sel = document.getElementById('tables'); sel.innerHTML = '';
    for (let i = 1; i <= 50; i++) {
      const o = document.createElement('option'); o.value = i; o.textContent = i; sel.appendChild(o);
    }
  }

  function startPractice() {
    document.getElementById('controls').style.display = 'none';

    mode = document.getElementById('mode').value;
    tables = Array.from(document.getElementById('tables').selectedOptions).map(o => +o.value);
    if (!tables.length) return alert('Select at least one table/number.');

    const st = document.getElementById('session-type').value;
    if (st === 'time') practiceSeconds = +document.getElementById('practice-time').value * 60;
    else questionLimit = +document.getElementById('question-count').value;

    score = 0; totalQuestions = 0; totalAttempts = 0; startTime = Date.now();
    const ansInput = document.getElementById('answer');
    ansInput.style.display = 'block'; ansInput.focus();
    updateProgressBar(0, questionLimit || 1);
    nextQuestion();

    function finish() {
      const acc = totalAttempts ? ((score/totalAttempts)*100).toFixed(1) : 0;
      alert(`Session over! Score: ${score}/${totalQuestions}, Accuracy: ${acc}%`);
    }

    function nextQuestion() {
      if ((st === 'count' && totalQuestions >= questionLimit) ||
          (st === 'time' && ((Date.now()-startTime)/1000) >= practiceSeconds)) {
        finish();
        clearInterval(timerInt);
        return;
      }

      totalQuestions++;
      const a = tables[Math.floor(Math.random()*tables.length)];
      let b;
      if (mode === 'exponent') {
        const mi = +document.getElementById('exponent-min').value;
        const ma = +document.getElementById('exponent-max').value;
        b = Math.floor(Math.random() * (ma - mi + 1)) + mi;
      } else if (mode === 'count') b = +document.getElementById('count-step').value;
      else b = Math.ceil(Math.random()*10);

      switch(mode) {
        case 'multiplication': currentAnswer = a*b; break;
        case 'division': currentAnswer = b; break;
        case 'square': currentAnswer = a*a; break;
        case 'cube': currentAnswer = a*a*a; break;
        case 'exponent': currentAnswer = Math.pow(a,b); break;
        case 'count': currentAnswer = a+b; break;
      }
      answerStr = currentAnswer.toString();

      let qText = '';
      switch(mode) {
        case 'multiplication': qText = `${a} × ${b}`; break;
        case 'division': qText = `${a*b} ÷ ${a}`; break;
        case 'square': qText = `${a}²`; break;
        case 'cube': qText = `${a}³`; break;
        case 'exponent': qText = `${a}^${b}`; break;
        case 'count': qText = `Count by ${b} from ${a}`; break;
      }

      document.getElementById('question-label').textContent = qText;
      ansInput.value = '';
      ansInput.classList.remove('wrong');
      ansInput.focus();
      document.getElementById('result').textContent = '';
      document.getElementById('score').textContent = `Score: ${score}/${totalQuestions}`;
      const initialAcc = totalAttempts ? ((score/totalAttempts)*100).toFixed(1) : 0;
      document.getElementById('accuracy').textContent = `Accuracy: ${initialAcc}%`;
      updateProgressBar(score, questionLimit);
    }

    document.getElementById('answer').oninput = e => {
      const val = e.target.value;
      if (val.length < answerStr.length) return;
      totalAttempts++;
      const num = +val;
      if (num === currentAnswer) {
        score++;
        document.getElementById('result').textContent = 'Correct!';
        document.getElementById('score').textContent = `Score: ${score}/${totalQuestions}`;
        setTimeout(nextQuestion, 500);
      } else {
        const inp = e.target;
        inp.classList.add('wrong');
        document.getElementById('result').textContent = 'Try again';
        setTimeout(() => { inp.value = ''; inp.classList.remove('wrong'); inp.focus(); }, 1000);
      }
      const acc = totalAttempts ? ((score/totalAttempts)*100).toFixed(1) : 0;
      document.getElementById('accuracy').textContent = `Accuracy: ${acc}%`;
    };

    const timerInt = setInterval(() => {
      if (st !== 'time') return;
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      const left = practiceSeconds - elapsed;
      if (left <= 0) {
        document.getElementById('session-timer').textContent = `⏳ Time left: 0m 00s`;
        finish();
        clearInterval(timerInt);
        return;
      }
      const mins = Math.floor(left / 60);
      const secs = left % 60;
      const paddedSecs = secs < 10 ? '0' + secs : secs;
      document.getElementById('session-timer').textContent = `⏳ Time left: ${mins}m ${paddedSecs}s`;
    }, 500);
  }

  document.addEventListener('DOMContentLoaded', () => { populateTables(); toggleOptions(); toggleSessionType(); });
</script>
</body>
</html>
